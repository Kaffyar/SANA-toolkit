{% extends "base.html" %}

{% block title %}SANA Toolkit - Advanced Network Security Platform{% endblock %}

{% block page_icon %}<i class="fas fa-tachometer-alt"></i>{% endblock %}
{% block page_title %}Security Dashboard{% endblock %}
{% block page_subtitle %}Network Security Analysis Toolkit{% endblock %}

{% block content %}
<!-- Hero Section with Quick Actions -->
<div class="card glass mb-4">
    <div class="card-content">
        <h1 class="gradient-text mb-2">Network Security Analysis Toolkit</h1>
        <p class="text-lg mb-4">Discover, analyze and secure your network infrastructure with our comprehensive security tools</p>
        <div class="d-flex gap-3 flex-wrap">
            <a href="{{ url_for('nmap_scanner') }}" class="btn btn-primary">
                <i class="fas fa-search"></i>
                Network Scan
            </a>
            <a href="{{ url_for('host_discovery.host_discovery_page') }}" class="btn btn-secondary">
                <i class="fas fa-server"></i>
                Host Discovery
            </a>
            <a href="{{ url_for('dns_recon.dns_recon_page') }}" class="btn btn-outline">
                <i class="fas fa-globe"></i>
                DNS Lookup
            </a>
            <a href="{{ url_for('virustotal.virustotal_page') }}" class="btn btn-primary">
                <i class="fas fa-shield-virus"></i>
                VirusTotal
            </a>
        </div>
    </div>
</div>

<!-- Security Stats Overview -->
<div class="d-flex gap-4 mb-4">
    <div class="stats-card" style="flex: 1">
        <div class="stats-icon primary">
            <i class="fas fa-shield-alt"></i>
        </div>
        <div class="stats-content">
            <div class="stats-value" id="security-score">95</div>
            <div class="stats-label">Security Score</div>
        </div>
    </div>
    <div class="stats-card" style="flex: 1">
        <div class="stats-icon success">
            <i class="fas fa-server"></i>
        </div>
        <div class="stats-content">
            <div class="stats-value" id="hosts-count">24</div>
            <div class="stats-label">Active Hosts</div>
        </div>
    </div>
    <div class="stats-card" style="flex: 1">
        <div class="stats-icon warning">
            <i class="fas fa-door-open"></i>
        </div>
        <div class="stats-content">
            <div class="stats-value" id="ports-count">156</div>
            <div class="stats-label">Open Ports</div>
        </div>
    </div>
    <div class="stats-card" style="flex: 1">
        <div class="stats-icon danger">
            <i class="fas fa-bug"></i>
        </div>
        <div class="stats-content">
            <div class="stats-value" id="vulns-count">3</div>
            <div class="stats-label">Vulnerabilities</div>
        </div>
    </div>
</div>

<!-- Security Tools Section -->
<h3 class="mb-3"><i class="fas fa-tools"></i> Security Tools</h3>
<div class="d-flex gap-4 flex-wrap">
    <!-- Nmap Scanner Tool -->
    <div class="card hover-lift" style="flex: 1; min-width: 300px;">
        <div class="card-header">
            <h4 class="card-title"><i class="fas fa-search-plus"></i> Network Scanner</h4>
        </div>
        <p class="mb-3">Scan networks for open ports and detect running services with Nmap technology</p>
        <div class="d-flex gap-2 flex-wrap mb-3">
            <span class="badge bg-primary">Port Scanning</span>
            <span class="badge bg-secondary">Service Detection</span>
            <span class="badge bg-info">OS Fingerprinting</span>
        </div>
        <a href="{{ url_for('nmap_scanner') }}" class="btn btn-primary">
            Launch Scanner <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- Host Discovery Tool -->
    <div class="card hover-lift" style="flex: 1; min-width: 300px;">
        <div class="card-header">
            <h4 class="card-title"><i class="fas fa-network-wired"></i> Host Discovery</h4>
        </div>
        <p class="mb-3">Find active hosts on your network using various discovery techniques</p>
        <div class="d-flex gap-2 flex-wrap mb-3">
            <span class="badge bg-primary">ARP Scan</span>
            <span class="badge bg-secondary">ICMP Ping</span>
            <span class="badge bg-info">TCP/UDP Discovery</span>
        </div>
        <a href="{{ url_for('host_discovery.host_discovery_page') }}" class="btn btn-primary">
            Discover Hosts <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- DNS Reconnaissance Tool -->
    <div class="card hover-lift" style="flex: 1; min-width: 300px;">
        <div class="card-header">
            <h4 class="card-title"><i class="fas fa-globe"></i> DNS Reconnaissance</h4>
        </div>
        <p class="mb-3">Discover DNS information, subdomains and related records for domains</p>
        <div class="d-flex gap-2 flex-wrap mb-3">
            <span class="badge bg-primary">Subdomain Discovery</span>
            <span class="badge bg-secondary">DNS Records</span>
            <span class="badge bg-info">Zone Transfers</span>
        </div>
        <a href="{{ url_for('dns_recon.dns_recon_page') }}" class="btn btn-primary">
            DNS Lookup <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- VirusTotal Integration Tool -->
    <div class="card hover-lift" style="flex: 1; min-width: 300px;">
        <div class="card-header">
            <h4 class="card-title"><i class="fas fa-shield-virus"></i> VirusTotal Scanner</h4>
        </div>
        <p class="mb-3">Check files, URLs and domains against multiple antivirus engines</p>
        <div class="d-flex gap-2 flex-wrap mb-3">
            <span class="badge bg-primary">Malware Detection</span>
            <span class="badge bg-secondary">URL Scanning</span>
            <span class="badge bg-info">Domain Reputation</span>
        </div>
        <a href="{{ url_for('virustotal.virustotal_page') }}" class="btn btn-primary">
            Scan Threats <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- Scan History Tool -->
    <div class="card hover-lift" style="flex: 1; min-width: 300px;">
        <div class="card-header">
            <h4 class="card-title"><i class="fas fa-history"></i> Scan History</h4>
        </div>
        <p class="mb-3">View past scan results and track changes in your network security posture</p>
        <div class="d-flex gap-2 flex-wrap mb-3">
            <span class="badge bg-primary">Historical Data</span>
            <span class="badge bg-secondary">Trend Analysis</span>
            <span class="badge bg-info">Security Reports</span>
        </div>
        <a href="{{ url_for('scan_history.scan_history') }}" class="btn btn-primary">
            View History <i class="fas fa-arrow-right"></i>
        </a>
    </div>
</div>

<!-- Recent Activity Section -->
<h3 class="mt-4 mb-3"><i class="fas fa-chart-line"></i> Recent Activity</h3>
<div class="card glass">
    <div class="activity-list" id="recent-activity">
        <!-- Activity items will be dynamically added here -->
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Animate stats when they come into view
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('fade-in');
                observer.unobserve(entry.target);
            }
        });
    });

    document.querySelectorAll('.stats-card').forEach(card => {
        observer.observe(card);
        card.classList.add('animate-on-scroll');
    });

    // Example activity data - replace with real data from your backend
    const activities = [
        {
            type: 'scan',
            target: '192.168.1.0/24',
            timestamp: '2 minutes ago',
            status: 'success'
        },
        {
            type: 'vulnerability',
            target: 'server1.local',
            timestamp: '15 minutes ago',
            status: 'warning'
        },
        {
            type: 'dns',
            target: 'example.com',
            timestamp: '1 hour ago',
            status: 'info'
        }
    ];

    // Render activity items
    const activityList = document.getElementById('recent-activity');
    activities.forEach(activity => {
        const item = document.createElement('div');
        item.className = `activity-item ${activity.status}`;
        item.innerHTML = `
            <div class="activity-icon">
                <i class="fas fa-${activity.type === 'scan' ? 'search' : activity.type === 'vulnerability' ? 'bug' : 'globe'}"></i>
            </div>
            <div class="activity-content">
                <div class="activity-title">${activity.type.charAt(0).toUpperCase() + activity.type.slice(1)} completed</div>
                <div class="activity-details">${activity.target}</div>
                <div class="activity-time">${activity.timestamp}</div>
            </div>
        `;
        activityList.appendChild(item);
    });
});
</script>
{% endblock %}